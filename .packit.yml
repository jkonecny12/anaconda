# ======================================
# WARNING!
# THIS FILE IS GENERATED FROM A TEMPLATE
# DO NOT EDIT THIS FILE MANUALLY!
# ======================================
# The template is located in: .packit.yml.j2

specfile_path: anaconda.spec
upstream_package_name: anaconda
upstream_tag_template: anaconda-{version}-1
copy_upstream_release_description: true

srpm_build_deps:
  - automake
  - autoconf
  - autogen
  - glib2-devel
  - gettext-devel
  - python3-polib
  - gobject-introspection-devel
  - glade-devel
  - libxklavier-devel
  - libarchive-devel
  - rpm-devel
  - nss_wrapper
  - nodejs-npm

actions:
  post-upstream-clone:
    - ./autogen.sh
    - ./configure
  create-archive:
    - "make release"
    - 'bash -c "ls -1 anaconda-*.tar.bz2"'

jobs:


  - job: propose_downstream
    trigger: release
    dist_git_branches: main

# TODO: Return back the test when DNF5 issue is resolved
# https://gitlab.com/testing-farm/tests/-/merge_requests/24
#  - job: tests
#   trigger: pull_request
#    targets:
#      - fedora-rawhide

  - job: copr_build
    trigger: pull_request
    targets:
      - fedora-rawhide
    additional_repos:
      # This repository contains fixup of Rawhide broken environment.
      # Mainly useful when there is a package which is not yet in Rawhide but build is available.
      - "https://fedorapeople.org/groups/anaconda/repos/anaconda_fixup_repo/"

  - job: copr_build
    trigger: commit
    targets:
      - fedora-rawhide
    branch: master
    owner: "@rhinstaller"
    project: Anaconda
    additional_repos:
      # This repository contains fixup of Rawhide broken environment.
      # Mainly useful when there is a package which is not yet in Rawhide but build is available.
      - "https://fedorapeople.org/groups/anaconda/repos/anaconda_fixup_repo/"
    preserve_project: True

